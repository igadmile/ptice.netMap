L.Control.Fullscreen=L.Control.extend({options:{position:"topleft",title:{"false":"View Fullscreen","true":"Exit Fullscreen"}},onAdd:function(map){var container=L.DomUtil.create("div","leaflet-control-fullscreen leaflet-bar leaflet-control");this.link=L.DomUtil.create("a","leaflet-control-fullscreen-button leaflet-bar-part",container);this.link.href="#";this._map=map;this._map.on("fullscreenchange",this._toggleTitle,this);this._toggleTitle();L.DomEvent.on(this.link,"click",this._click,this);return container},_click:function(e){L.DomEvent.stopPropagation(e);L.DomEvent.preventDefault(e);this._map.toggleFullscreen(this.options)},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()]}});L.Map.include({isFullscreen:function(){return this._isFullscreen||false},toggleFullscreen:function(options){var container=this.getContainer();if(this.isFullscreen()){if(options&&options.pseudoFullscreen){this._disablePseudoFullscreen(container)}else if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else{this._disablePseudoFullscreen(container)}}else{if(options&&options.pseudoFullscreen){this._enablePseudoFullscreen(container)}else if(container.requestFullscreen){container.requestFullscreen()}else if(container.mozRequestFullScreen){container.mozRequestFullScreen()}else if(container.webkitRequestFullscreen){container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}else if(container.msRequestFullscreen){container.msRequestFullscreen()}else{this._enablePseudoFullscreen(container)}}},_enablePseudoFullscreen:function(container){L.DomUtil.addClass(container,"leaflet-pseudo-fullscreen");this._setFullscreen(true);this.fire("fullscreenchange")},_disablePseudoFullscreen:function(container){L.DomUtil.removeClass(container,"leaflet-pseudo-fullscreen");this._setFullscreen(false);this.fire("fullscreenchange")},_setFullscreen:function(fullscreen){this._isFullscreen=fullscreen;var container=this.getContainer();if(fullscreen){L.DomUtil.addClass(container,"leaflet-fullscreen-on")}else{L.DomUtil.removeClass(container,"leaflet-fullscreen-on")}this.invalidateSize()},_onFullscreenChange:function(e){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(fullscreenElement===this.getContainer()&&!this._isFullscreen){this._setFullscreen(true);this.fire("fullscreenchange")}else if(fullscreenElement!==this.getContainer()&&this._isFullscreen){this._setFullscreen(false);this.fire("fullscreenchange")}}});L.Map.mergeOptions({fullscreenControl:false});L.Map.addInitHook(function(){if(this.options.fullscreenControl){this.fullscreenControl=new L.Control.Fullscreen(this.options.fullscreenControl);this.addControl(this.fullscreenControl)}var fullscreenchange;if("onfullscreenchange"in document){fullscreenchange="fullscreenchange"}else if("onmozfullscreenchange"in document){fullscreenchange="mozfullscreenchange"}else if("onwebkitfullscreenchange"in document){fullscreenchange="webkitfullscreenchange"}else if("onmsfullscreenchange"in document){fullscreenchange="MSFullscreenChange"}if(fullscreenchange){var onFullscreenChange=L.bind(this._onFullscreenChange,this);this.whenReady(function(){L.DomEvent.on(document,fullscreenchange,onFullscreenChange)});this.on("unload",function(){L.DomEvent.off(document,fullscreenchange,onFullscreenChange)})}});L.control.fullscreen=function(options){return new L.Control.Fullscreen(options)};L.Control.StyledLayerControl=L.Control.Layers.extend({options:{collapsed:true,position:"topright",autoZIndex:true},initialize:function(baseLayers,groupedOverlays,options){var i,j;L.Util.setOptions(this,options);this._layers={};this._lastZIndex=0;this._handlingClick=false;this._groupList=[];this._domGroups=[];for(i in baseLayers){for(var j in baseLayers[i].layers){this._addLayer(baseLayers[i].layers[j],j,baseLayers[i],false)}}for(i in groupedOverlays){for(var j in groupedOverlays[i].layers){this._addLayer(groupedOverlays[i].layers[j],j,groupedOverlays[i],true)}}},onAdd:function(map){this._initLayout();this._update();map.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this);return this._container},onRemove:function(map){map.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(layer,name,group){this._addLayer(layer,name,group,false);this._update();return this},addOverlay:function(layer,name,group){this._addLayer(layer,name,group,true);this._update();return this},removeLayer:function(layer){var id=L.Util.stamp(layer);delete this._layers[id];this._update();return this},removeGroup:function(group_Name){for(group in this._groupList){if(this._groupList[group].groupName==group_Name){for(layer in this._layers){if(this._layers[layer].group&&this._layers[layer].group.name==group_Name){delete this._layers[layer]}}delete this._groupList[group];this._update();break}}},_initLayout:function(){var className="leaflet-control-layers",container=this._container=L.DomUtil.create("div",className);container.setAttribute("aria-haspopup",true);if(!L.Browser.touch){L.DomEvent.disableClickPropagation(container);L.DomEvent.on(container,"wheel",L.DomEvent.stopPropagation)}else{L.DomEvent.on(container,"click",L.DomEvent.stopPropagation)}var section=document.createElement("section");section.className="ac-container "+className+"-list";var form=this._form=L.DomUtil.create("form");section.appendChild(form);if(this.options.collapsed){if(!L.Browser.android){L.DomEvent.on(container,"mouseover",this._expand,this).on(container,"mouseout",this._collapse,this)}var link=this._layersLink=L.DomUtil.create("a",className+"-toggle",container);link.href="#";link.title="Layers";if(L.Browser.touch){L.DomEvent.on(link,"click",L.DomEvent.stop).on(link,"click",this._expand,this)}else{L.DomEvent.on(link,"focus",this._expand,this)}this._map.on("click",this._collapse,this)}else{this._expand()}this._baseLayersList=L.DomUtil.create("div",className+"-base",form);this._overlaysList=L.DomUtil.create("div",className+"-overlays",form);container.appendChild(section);for(var c=0;c<(containers=container.getElementsByClassName("ac-container")).length;c++){if(this.options.container_width){containers[c].style.width=this.options.container_width}this._default_maxHeight=this.options.container_maxHeight?this.options.container_maxHeight:this._map._size.y-70;containers[c].style.maxHeight=this._default_maxHeight+"px"}window.onresize=this._on_resize_window.bind(this)},_on_resize_window:function(){for(var c=0;c<containers.length;c++){containers[c].style.maxHeight=window.innerHeight-90<this._removePxToInt(this._default_maxHeight)?window.innerHeight-90+"px":this._removePxToInt(this._default_maxHeight)+"px"}},_removePxToInt:function(value){return parseInt(value.replace("px",""))},_addLayer:function(layer,name,group,overlay){var id=L.Util.stamp(layer);this._layers[id]={layer:layer,name:name,overlay:overlay};if(group){var groupId=this._groupList.indexOf(group);if(groupId===-1){for(g in this._groupList){if(this._groupList[g].groupName==group.groupName){groupId=g;break}}}if(groupId===-1){groupId=this._groupList.push(group)-1}this._layers[id].group={name:group.groupName,id:groupId,expanded:group.expanded}}if(this.options.autoZIndex&&layer.setZIndex){this._lastZIndex++;layer.setZIndex(this._lastZIndex)}},_update:function(){if(!this._container){return}this._baseLayersList.innerHTML="";this._overlaysList.innerHTML="";this._domGroups.length=0;var baseLayersPresent=false,overlaysPresent=false,i,obj;for(i in this._layers){obj=this._layers[i];this._addItem(obj);overlaysPresent=overlaysPresent||obj.overlay;baseLayersPresent=baseLayersPresent||!obj.overlay}},_onLayerChange:function(e){var obj=this._layers[L.Util.stamp(e.layer)];if(!obj){return}if(!this._handlingClick){this._update()}var type=obj.overlay?e.type==="layeradd"?"overlayadd":"overlayremove":e.type==="layeradd"?"baselayerchange":null;if(type){this._map.fire(type,obj)}},_createRadioElement:function(name,checked){var radioHtml='<input type="radio" class="leaflet-control-layers-selector" name="'+name+'"';if(checked){radioHtml+=' checked="checked"'}radioHtml+="/>";var radioFragment=document.createElement("div");radioFragment.innerHTML=radioHtml;return radioFragment.firstChild},_addItem:function(obj){var label=document.createElement("div"),input,checked=this._map.hasLayer(obj.layer),container;if(obj.overlay){input=document.createElement("input");input.type="checkbox";input.className="leaflet-control-layers-selector";input.defaultChecked=checked;label.className="menu-item-checkbox"}else{input=this._createRadioElement("leaflet-base-layers",checked);label.className="menu-item-radio"}input.layerId=L.Util.stamp(obj.layer);L.DomEvent.on(input,"click",this._onInputClick,this);var name=document.createElement("span");name.innerHTML=" "+obj.name;label.appendChild(input);label.appendChild(name);if(obj.layer.StyledLayerControl&&obj.layer.StyledLayerControl.removable){var bt_delete=document.createElement("input");bt_delete.type="button";bt_delete.className="bt_delete";L.DomEvent.on(bt_delete,"click",this._onDeleteClick,this);label.appendChild(bt_delete)}if(obj.overlay){container=this._overlaysList}else{container=this._baseLayersList}var groupContainer=this._domGroups[obj.group.id];if(!groupContainer){groupContainer=document.createElement("div");groupContainer.id="leaflet-control-accordion-layers-"+obj.group.id;var s_expanded=obj.group.expanded?' checked = "true" ':"";var s_type_exclusive=this.options.exclusive?' type="radio" ':' type="checkbox" ';inputElement='<input id="ac'+obj.group.id+'" name="accordion-1" class="menu" '+s_expanded+s_type_exclusive+"/>";inputLabel='<label for="ac'+obj.group.id+'">'+obj.group.name+"</label>";article=document.createElement("article");article.className="ac-large";article.appendChild(label);if(this.options.group_maxHeight){article.style.maxHeight=this.options.group_maxHeight}groupContainer.innerHTML=inputElement+inputLabel;groupContainer.appendChild(article);container.appendChild(groupContainer);this._domGroups[obj.group.id]=groupContainer}else{groupContainer.lastElementChild.appendChild(label)}return label},_onInputClick:function(){var i,input,obj,inputs=this._form.getElementsByTagName("input"),inputsLen=inputs.length;this._handlingClick=true;for(i=0;i<inputsLen;i++){input=inputs[i];obj=this._layers[input.layerId];if(!obj){continue}if(input.checked&&!this._map.hasLayer(obj.layer)){this._map.addLayer(obj.layer)}else if(!input.checked&&this._map.hasLayer(obj.layer)){this._map.removeLayer(obj.layer)}}this._handlingClick=false},_onDeleteClick:function(obj){var node=obj.target.parentElement.childNodes[0];n_obj=this._layers[node.layerId];if(!n_obj.overlay&&node.checked){return false}if(this._map.hasLayer(n_obj.layer)){this._map.removeLayer(n_obj.layer)}this.removeLayer(n_obj.layer);obj.target.parentNode.remove();return false},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}});L.Control.styledLayerControl=function(baseLayers,overlays,options){return new L.Control.StyledLayerControl(baseLayers,overlays,options)};(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.leafletControlGeocoder=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Nominatim=_dereq_("./geocoders/nominatim")["class"];module.exports={"class":L.Control.extend({options:{showResultIcons:false,collapsed:true,expand:"click",position:"topright",placeholder:"Search...",errorMessage:"Nothing found.",suggestMinLength:3,suggestTimeout:250,defaultMarkGeocode:true},includes:L.Mixin.Events,initialize:function(options){L.Util.setOptions(this,options);if(!this.options.geocoder){this.options.geocoder=new Nominatim}this._requestCount=0},onAdd:function(map){var className="leaflet-control-geocoder",container=L.DomUtil.create("div",className+" leaflet-bar"),icon=L.DomUtil.create("button",className+"-icon",container),form=this._form=L.DomUtil.create("div",className+"-form",container),input;this._map=map;this._container=container;icon.innerHTML="&nbsp;";icon.type="button";input=this._input=L.DomUtil.create("input","",form);input.type="text";input.placeholder=this.options.placeholder;this._errorElement=L.DomUtil.create("div",className+"-form-no-error",container);this._errorElement.innerHTML=this.options.errorMessage;this._alts=L.DomUtil.create("ul",className+"-alternatives leaflet-control-geocoder-alternatives-minimized",container);L.DomEvent.disableClickPropagation(this._alts);L.DomEvent.addListener(input,"keydown",this._keydown,this);L.DomEvent.addListener(input,"blur",function(){if(this.options.collapsed&&!this._preventBlurCollapse){this._collapse()}this._preventBlurCollapse=false},this);if(this.options.collapsed){if(this.options.expand==="click"){L.DomEvent.addListener(icon,"click",function(e){if(e.button===0&&e.detail!==2){this._toggle()}},this)}else{L.DomEvent.addListener(icon,"mouseover",this._expand,this);L.DomEvent.addListener(icon,"mouseout",this._collapse,this);this._map.on("movestart",this._collapse,this)}}else{L.DomEvent.addListener(icon,"click",function(e){this._geocode(e)},this);this._expand()}if(this.options.defaultMarkGeocode){this.on("markgeocode",this.markGeocode,this)}this.on("startgeocode",function(){L.DomUtil.addClass(this._container,"leaflet-control-geocoder-throbber")},this);this.on("finishgeocode",function(){L.DomUtil.removeClass(this._container,"leaflet-control-geocoder-throbber")},this);L.DomEvent.disableClickPropagation(container);return container},_geocodeResult:function(results,suggest){if(!suggest&&results.length===1){this._geocodeResultSelected(results[0])}else if(results.length>0){this._alts.innerHTML="";this._results=results;L.DomUtil.removeClass(this._alts,"leaflet-control-geocoder-alternatives-minimized");for(var i=0;i<results.length;i++){this._alts.appendChild(this._createAlt(results[i],i))}}else{L.DomUtil.addClass(this._errorElement,"leaflet-control-geocoder-error")}},markGeocode:function(result){result=result.geocode||result;this._map.fitBounds(result.bbox);if(this._geocodeMarker){this._map.removeLayer(this._geocodeMarker)}this._geocodeMarker=new L.Marker(result.center).bindPopup(result.html||result.name).addTo(this._map).openPopup();return this},_geocode:function(suggest){var requestCount=++this._requestCount,mode=suggest?"suggest":"geocode";this._lastGeocode=this._input.value;if(!suggest){this._clearResults()}this.fire("start"+mode);this.options.geocoder[mode](this._input.value,function(results){if(requestCount===this._requestCount){this.fire("finish"+mode);this._geocodeResult(results,suggest)}},this)},_geocodeResultSelected:function(result){if(!this.options.collapsed){this._clearResults()}this.fire("markgeocode",{geocode:result})},_toggle:function(){if(this._container.className.indexOf("leaflet-control-geocoder-expanded")>=0){this._collapse()}else{this._expand()}},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded");this._input.select();this.fire("expand")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-geocoder-expanded","");L.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized");L.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error");this.fire("collapse")},_clearResults:function(){L.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized");this._selection=null;L.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error")},_createAlt:function(result,index){var li=L.DomUtil.create("li",""),a=L.DomUtil.create("a","",li),icon=this.options.showResultIcons&&result.icon?L.DomUtil.create("img","",a):null,text=result.html?undefined:document.createTextNode(result.name),mouseDownHandler=function mouseDownHandler(e){this._preventBlurCollapse=true;L.DomEvent.stop(e);this._geocodeResultSelected(result);L.DomEvent.on(li,"click",function(){if(this.options.collapsed){this._collapse()}},this)};if(icon){icon.src=result.icon}li.setAttribute("data-result-index",index);if(result.html){a.innerHTML=a.innerHTML+result.html}else{a.appendChild(text)}L.DomEvent.addListener(li,"mousedown",mouseDownHandler,this);return li},_keydown:function(e){var _this=this,select=function select(dir){if(_this._selection){L.DomUtil.removeClass(_this._selection,"leaflet-control-geocoder-selected");_this._selection=_this._selection[dir>0?"nextSibling":"previousSibling"]}if(!_this._selection){_this._selection=_this._alts[dir>0?"firstChild":"lastChild"]}if(_this._selection){L.DomUtil.addClass(_this._selection,"leaflet-control-geocoder-selected")}};switch(e.keyCode){case 27:if(this.options.collapsed){this._collapse()}break;case 38:select(-1);L.DomEvent.preventDefault(e);break;case 40:select(1);L.DomEvent.preventDefault(e);break;case 13:if(this._selection){var index=parseInt(this._selection.getAttribute("data-result-index"),10);this._geocodeResultSelected(this._results[index]);this._clearResults()}else{this._geocode()}L.DomEvent.preventDefault(e);break;default:var v=this._input.value;if(this.options.geocoder.suggest&&v!==this._lastGeocode){clearTimeout(this._suggestTimeout);if(v.length>=this.options.suggestMinLength){this._suggestTimeout=setTimeout(L.bind(function(){this._geocode(true)},this),this.options.suggestTimeout)}else{this._clearResults()}}}}}),factory:function(options){return new L.Control.Geocoder(options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./geocoders/nominatim":9}],2:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{service_url:"http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"},initialize:function(accessToken,options){L.setOptions(this,options);this._accessToken=accessToken},geocode:function(query,cb,context){var params={SingleLine:query,outFields:"Addr_Type",forStorage:false,maxLocations:10,f:"json"};if(this._key&&this._key.length){params.token=this._key}Util.getJSON(this.options.service_url+"/findAddressCandidates",params,function(data){var results=[],loc,latLng,latLngBounds;if(data.candidates&&data.candidates.length){for(var i=0;i<=data.candidates.length-1;i++){loc=data.candidates[i];latLng=L.latLng(loc.location.y,loc.location.x);latLngBounds=L.latLngBounds(L.latLng(loc.extent.ymax,loc.extent.xmax),L.latLng(loc.extent.ymin,loc.extent.xmin));results[i]={name:loc.address,bbox:latLngBounds,center:latLng}}}cb.call(context,results)})},suggest:function(query,cb,context){return this.geocode(query,cb,context)},reverse:function(location,scale,cb,context){var params={location:encodeURIComponent(location.lng)+","+encodeURIComponent(location.lat),distance:100,f:"json"};Util.getJSON(this.options.service_url+"/reverseGeocode",params,function(data){var result=[],loc;if(data&&!data.error){loc=L.latLng(data.location.y,data.location.x);result.push({name:data.address.Match_addr,center:loc,bounds:L.latLngBounds(loc,loc)})}cb.call(context,result)})}}),factory:function(accessToken,options){return new L.Control.Geocoder.ArcGis(accessToken,options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],3:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({initialize:function(key){this.key=key},geocode:function(query,cb,context){Util.jsonp("https://dev.virtualearth.net/REST/v1/Locations",{query:query,key:this.key},function(data){var results=[];if(data.resourceSets.length>0){for(var i=data.resourceSets[0].resources.length-1;i>=0;i--){var resource=data.resourceSets[0].resources[i],bbox=resource.bbox;results[i]={name:resource.name,bbox:L.latLngBounds([bbox[0],bbox[1]],[bbox[2],bbox[3]]),center:L.latLng(resource.point.coordinates)}}}cb.call(context,results)},this,"jsonp")},reverse:function(location,scale,cb,context){Util.jsonp("//dev.virtualearth.net/REST/v1/Locations/"+location.lat+","+location.lng,{key:this.key},function(data){var results=[];for(var i=data.resourceSets[0].resources.length-1;i>=0;i--){var resource=data.resourceSets[0].resources[i],bbox=resource.bbox;results[i]={name:resource.name,bbox:L.latLngBounds([bbox[0],bbox[1]],[bbox[2],bbox[3]]),center:L.latLng(resource.point.coordinates)}}cb.call(context,results)},this,"jsonp")}}),factory:function(key){return new L.Control.Geocoder.Bing(key)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],4:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{serviceUrl:"https://maps.googleapis.com/maps/api/geocode/json",geocodingQueryParams:{},reverseQueryParams:{}},initialize:function(key,options){this._key=key;L.setOptions(this,options);this.options.serviceUrl=this.options.service_url||this.options.serviceUrl},geocode:function(query,cb,context){var params={address:query};if(this._key&&this._key.length){params.key=this._key}params=L.Util.extend(params,this.options.geocodingQueryParams);Util.getJSON(this.options.serviceUrl,params,function(data){var results=[],loc,latLng,latLngBounds;if(data.results&&data.results.length){for(var i=0;i<=data.results.length-1;i++){loc=data.results[i];latLng=L.latLng(loc.geometry.location);latLngBounds=L.latLngBounds(L.latLng(loc.geometry.viewport.northeast),L.latLng(loc.geometry.viewport.southwest));results[i]={name:loc.formatted_address,bbox:latLngBounds,center:latLng,properties:loc.address_components}}}cb.call(context,results)})},reverse:function(location,scale,cb,context){var params={latlng:encodeURIComponent(location.lat)+","+encodeURIComponent(location.lng)};params=L.Util.extend(params,this.options.reverseQueryParams);if(this._key&&this._key.length){params.key=this._key}Util.getJSON(this.options.serviceUrl,params,function(data){var results=[],loc,latLng,latLngBounds;if(data.results&&data.results.length){for(var i=0;i<=data.results.length-1;i++){loc=data.results[i];latLng=L.latLng(loc.geometry.location);latLngBounds=L.latLngBounds(L.latLng(loc.geometry.viewport.northeast),L.latLng(loc.geometry.viewport.southwest));results[i]={name:loc.formatted_address,bbox:latLngBounds,center:latLng,properties:loc.address_components}}}cb.call(context,results)})}}),factory:function(key,options){return new L.Control.Geocoder.Google(key,options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],5:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{geocodeUrl:"http://geocoder.api.here.com/6.2/geocode.json",reverseGeocodeUrl:"http://reverse.geocoder.api.here.com/6.2/reversegeocode.json",app_id:"<insert your app_id here>",app_code:"<insert your app_code here>",geocodingQueryParams:{},reverseQueryParams:{}},initialize:function(options){L.setOptions(this,options)},geocode:function(query,cb,context){var params={searchtext:query,gen:9,app_id:this.options.app_id,app_code:this.options.app_code,jsonattributes:1};params=L.Util.extend(params,this.options.geocodingQueryParams);this.getJSON(this.options.geocodeUrl,params,cb,context)},reverse:function(location,scale,cb,context){var params={prox:encodeURIComponent(location.lat)+","+encodeURIComponent(location.lng),mode:"retrieveAddresses",app_id:this.options.app_id,app_code:this.options.app_code,gen:9,jsonattributes:1};params=L.Util.extend(params,this.options.reverseQueryParams);this.getJSON(this.options.reverseGeocodeUrl,params,cb,context)},getJSON:function(url,params,cb,context){Util.getJSON(url,params,function(data){var results=[],loc,latLng,latLngBounds;if(data.response.view&&data.response.view.length){for(var i=0;i<=data.response.view[0].result.length-1;i++){loc=data.response.view[0].result[i].location;latLng=L.latLng(loc.displayPosition.latitude,loc.displayPosition.longitude);latLngBounds=L.latLngBounds(L.latLng(loc.mapView.topLeft.latitude,loc.mapView.topLeft.longitude),L.latLng(loc.mapView.bottomRight.latitude,loc.mapView.bottomRight.longitude));results[i]={name:loc.address.label,bbox:latLngBounds,center:latLng}}}cb.call(context,results)})}}),factory:function(options){return new L.Control.Geocoder.HERE(options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],6:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{serviceUrl:"https://api.tiles.mapbox.com/v4/geocode/mapbox.places-v1/"},initialize:function(accessToken,options){L.setOptions(this,options);this._accessToken=accessToken},geocode:function(query,cb,context){Util.getJSON(this.options.serviceUrl+encodeURIComponent(query)+".json",{access_token:this._accessToken},function(data){var results=[],loc,latLng,latLngBounds;if(data.features&&data.features.length){for(var i=0;i<=data.features.length-1;i++){loc=data.features[i];latLng=L.latLng(loc.center.reverse());if(loc.hasOwnProperty("bbox")){latLngBounds=L.latLngBounds(L.latLng(loc.bbox.slice(0,2).reverse()),L.latLng(loc.bbox.slice(2,4).reverse()))}else{latLngBounds=L.latLngBounds(latLng,latLng)}results[i]={name:loc.place_name,bbox:latLngBounds,center:latLng}}}cb.call(context,results)})},suggest:function(query,cb,context){return this.geocode(query,cb,context)},reverse:function(location,scale,cb,context){Util.getJSON(this.options.serviceUrl+encodeURIComponent(location.lng)+","+encodeURIComponent(location.lat)+".json",{access_token:this._accessToken},function(data){var results=[],loc,latLng,latLngBounds;if(data.features&&data.features.length){for(var i=0;i<=data.features.length-1;i++){loc=data.features[i];latLng=L.latLng(loc.center.reverse());if(loc.hasOwnProperty("bbox")){latLngBounds=L.latLngBounds(L.latLng(loc.bbox.slice(0,2).reverse()),L.latLng(loc.bbox.slice(2,4).reverse()))}else{latLngBounds=L.latLngBounds(latLng,latLng)}results[i]={name:loc.place_name,bbox:latLngBounds,center:latLng}}}cb.call(context,results)})}}),factory:function(accessToken,options){return new L.Control.Geocoder.Mapbox(accessToken,options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],7:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{serviceUrl:"https://www.mapquestapi.com/geocoding/v1"},initialize:function(key,options){this._key=decodeURIComponent(key);L.Util.setOptions(this,options)},_formatName:function(){var r=[],i;for(i=0;i<arguments.length;i++){if(arguments[i]){r.push(arguments[i])}}return r.join(", ")},geocode:function(query,cb,context){Util.jsonp(this.options.serviceUrl+"/address",{key:this._key,location:query,limit:5,outFormat:"json"},function(data){var results=[],loc,latLng;if(data.results&&data.results[0].locations){for(var i=data.results[0].locations.length-1;i>=0;i--){loc=data.results[0].locations[i];latLng=L.latLng(loc.latLng);results[i]={name:this._formatName(loc.street,loc.adminArea4,loc.adminArea3,loc.adminArea1),bbox:L.latLngBounds(latLng,latLng),center:latLng}}}cb.call(context,results)},this)},reverse:function(location,scale,cb,context){Util.jsonp(this.options.serviceUrl+"/reverse",{key:this._key,location:location.lat+","+location.lng,outputFormat:"json"},function(data){var results=[],loc,latLng;if(data.results&&data.results[0].locations){for(var i=data.results[0].locations.length-1;i>=0;i--){loc=data.results[0].locations[i];latLng=L.latLng(loc.latLng);results[i]={name:this._formatName(loc.street,loc.adminArea4,loc.adminArea3,loc.adminArea1),bbox:L.latLngBounds(latLng,latLng),center:latLng}}}cb.call(context,results)},this)}}),factory:function(key,options){return new L.Control.Geocoder.MapQuest(key,options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],8:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{serviceUrl:"https://search.mapzen.com/v1",geocodingQueryParams:{},reverseQueryParams:{}},initialize:function(apiKey,options){L.Util.setOptions(this,options);this._apiKey=apiKey;this._lastSuggest=0},geocode:function(query,cb,context){var _this=this;Util.getJSON(this.options.serviceUrl+"/search",L.extend({api_key:this._apiKey,text:query},this.options.geocodingQueryParams),function(data){cb.call(context,_this._parseResults(data,"bbox"))})},suggest:function(query,cb,context){var _this=this;Util.getJSON(this.options.serviceUrl+"/autocomplete",L.extend({api_key:this._apiKey,text:query},this.options.geocodingQueryParams),L.bind(function(data){if(data.geocoding.timestamp>this._lastSuggest){this._lastSuggest=data.geocoding.timestamp;cb.call(context,_this._parseResults(data,"bbox"))}},this))},reverse:function(location,scale,cb,context){var _this=this;Util.getJSON(this.options.serviceUrl+"/reverse",L.extend({api_key:this._apiKey,"point.lat":location.lat,"point.lon":location.lng},this.options.reverseQueryParams),function(data){cb.call(context,_this._parseResults(data,"bounds"))})},_parseResults:function(data,bboxname){var results=[];L.geoJson(data,{pointToLayer:function(feature,latlng){return L.circleMarker(latlng)},onEachFeature:function(feature,layer){var result={},bbox,center;if(layer.getBounds){bbox=layer.getBounds();center=bbox.getCenter()}else{center=layer.getLatLng();bbox=L.latLngBounds(center,center)}result.name=layer.feature.properties.label;result.center=center;result[bboxname]=bbox;result.properties=layer.feature.properties;results.push(result)}});return results}}),factory:function(apiKey,options){return new L.Control.Geocoder.Mapzen(apiKey,options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],9:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{serviceUrl:"https://nominatim.openstreetmap.org/",geocodingQueryParams:{},reverseQueryParams:{},htmlTemplate:function(r){var a=r.address,parts=[];
if(a.road||a.building){parts.push("{building} {road} {house_number}")}if(a.city||a.town||a.village||a.hamlet){parts.push('<span class="'+(parts.length>0?"leaflet-control-geocoder-address-detail":"")+'">{postcode} {city} {town} {village} {hamlet}</span>')}if(a.state||a.country){parts.push('<span class="'+(parts.length>0?"leaflet-control-geocoder-address-context":"")+'">{state} {country}</span>')}return Util.template(parts.join("<br/>"),a,true)}},initialize:function(options){L.Util.setOptions(this,options)},geocode:function(query,cb,context){Util.jsonp(this.options.serviceUrl+"search",L.extend({q:query,limit:5,format:"json",addressdetails:1},this.options.geocodingQueryParams),function(data){var results=[];for(var i=data.length-1;i>=0;i--){var bbox=data[i].boundingbox;for(var j=0;j<4;j++)bbox[j]=parseFloat(bbox[j]);results[i]={icon:data[i].icon,name:data[i].display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(data[i]):undefined,bbox:L.latLngBounds([bbox[0],bbox[2]],[bbox[1],bbox[3]]),center:L.latLng(data[i].lat,data[i].lon),properties:data[i]}}cb.call(context,results)},this,"json_callback")},reverse:function(location,scale,cb,context){Util.jsonp(this.options.serviceUrl+"reverse",L.extend({lat:location.lat,lon:location.lng,zoom:Math.round(Math.log(scale/256)/Math.log(2)),addressdetails:1,format:"json"},this.options.reverseQueryParams),function(data){var result=[],loc;if(data&&data.lat&&data.lon){loc=L.latLng(data.lat,data.lon);result.push({name:data.display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(data):undefined,center:loc,bounds:L.latLngBounds(loc,loc),properties:data})}cb.call(context,result)},this,"json_callback")}}),factory:function(options){return new L.Control.Geocoder.Nominatim(options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],10:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{serviceUrl:"https://photon.komoot.de/api/",reverseUrl:"https://photon.komoot.de/reverse/",nameProperties:["name","street","suburb","hamlet","town","city","state","country"]},initialize:function(options){L.setOptions(this,options)},geocode:function(query,cb,context){var params=L.extend({q:query},this.options.geocodingQueryParams);Util.getJSON(this.options.serviceUrl,params,L.bind(function(data){cb.call(context,this._decodeFeatures(data))},this))},suggest:function(query,cb,context){return this.geocode(query,cb,context)},reverse:function(latLng,scale,cb,context){var params=L.extend({lat:latLng.lat,lon:latLng.lng},this.options.geocodingQueryParams);Util.getJSON(this.options.reverseUrl,params,L.bind(function(data){cb.call(context,this._decodeFeatures(data))},this))},_decodeFeatures:function(data){var results=[],i,f,c,latLng,extent,bbox;if(data&&data.features){for(i=0;i<data.features.length;i++){f=data.features[i];c=f.geometry.coordinates;latLng=L.latLng(c[1],c[0]);extent=f.properties.extent;if(extent){bbox=L.latLngBounds([extent[1],extent[0]],[extent[3],extent[2]])}else{bbox=L.latLngBounds(latLng,latLng)}results.push({name:this._deocodeFeatureName(f),center:latLng,bbox:bbox,properties:f.properties})}}return results},_deocodeFeatureName:function(f){var j,name;for(j=0;!name&&j<this.options.nameProperties.length;j++){name=f.properties[this.options.nameProperties[j]]}return name}}),factory:function(options){return new L.Control.Geocoder.Photon(options)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],11:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Util=_dereq_("../util");module.exports={"class":L.Class.extend({options:{serviceUrl:"https://api.what3words.com/v2/"},initialize:function(accessToken){this._accessToken=accessToken},geocode:function(query,cb,context){Util.getJSON(this.options.serviceUrl+"forward",{key:this._accessToken,addr:query.split(/\s+/).join(".")},function(data){var results=[],loc,latLng,latLngBounds;if(data.hasOwnProperty("geometry")){latLng=L.latLng(data.geometry["lat"],data.geometry["lng"]);latLngBounds=L.latLngBounds(latLng,latLng);results[0]={name:data.words,bbox:latLngBounds,center:latLng}}cb.call(context,results)})},suggest:function(query,cb,context){return this.geocode(query,cb,context)},reverse:function(location,scale,cb,context){Util.getJSON(this.options.serviceUrl+"reverse",{key:this._accessToken,coords:[location.lat,location.lng].join(",")},function(data){var results=[],loc,latLng,latLngBounds;if(data.status.status==200){latLng=L.latLng(data.geometry["lat"],data.geometry["lng"]);latLngBounds=L.latLngBounds(latLng,latLng);results[0]={name:data.words,bbox:latLngBounds,center:latLng}}cb.call(context,results)})}}),factory:function(accessToken){return new L.Control.Geocoder.What3Words(accessToken)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../util":13}],12:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,Control=_dereq_("./control"),Nominatim=_dereq_("./geocoders/nominatim"),Bing=_dereq_("./geocoders/bing"),MapQuest=_dereq_("./geocoders/mapquest"),Mapbox=_dereq_("./geocoders/mapbox"),What3Words=_dereq_("./geocoders/what3words"),Google=_dereq_("./geocoders/google"),Photon=_dereq_("./geocoders/photon"),Mapzen=_dereq_("./geocoders/mapzen"),ArcGis=_dereq_("./geocoders/arcgis"),HERE=_dereq_("./geocoders/here");module.exports=L.Util.extend(Control["class"],{Nominatim:Nominatim["class"],nominatim:Nominatim.factory,Bing:Bing["class"],bing:Bing.factory,MapQuest:MapQuest["class"],mapQuest:MapQuest.factory,Mapbox:Mapbox["class"],mapbox:Mapbox.factory,What3Words:What3Words["class"],what3words:What3Words.factory,Google:Google["class"],google:Google.factory,Photon:Photon["class"],photon:Photon.factory,Mapzen:Mapzen["class"],mapzen:Mapzen.factory,ArcGis:ArcGis["class"],arcgis:ArcGis.factory,HERE:HERE["class"],here:HERE.factory});L.Util.extend(L.Control,{Geocoder:module.exports,geocoder:Control.factory})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./control":1,"./geocoders/arcgis":2,"./geocoders/bing":3,"./geocoders/google":4,"./geocoders/here":5,"./geocoders/mapbox":6,"./geocoders/mapquest":7,"./geocoders/mapzen":8,"./geocoders/nominatim":9,"./geocoders/photon":10,"./geocoders/what3words":11}],13:[function(_dereq_,module,exports){(function(global){var L=typeof window!=="undefined"?window["L"]:typeof global!=="undefined"?global["L"]:null,lastCallbackId=0,htmlEscape=function(){var badChars=/[&<>"'`]/g;var possible=/[&<>"'`]/;var escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};function escapeChar(chr){return escape[chr]}return function(string){if(string==null){return""}else if(!string){return string+""}string=""+string;if(!possible.test(string)){return string}return string.replace(badChars,escapeChar)}}();module.exports={jsonp:function(url,params,callback,context,jsonpParam){var callbackId="_l_geocoder_"+lastCallbackId++;params[jsonpParam||"callback"]=callbackId;window[callbackId]=L.Util.bind(callback,context);var script=document.createElement("script");script.type="text/javascript";script.src=url+L.Util.getParamString(params);script.id=callbackId;document.getElementsByTagName("head")[0].appendChild(script)},getJSON:function(url,params,callback){var xmlHttp=new XMLHttpRequest;xmlHttp.onreadystatechange=function(){if(xmlHttp.readyState!==4){return}if(xmlHttp.status!==200&&xmlHttp.status!==304){callback("");return}callback(JSON.parse(xmlHttp.response))};xmlHttp.open("GET",url+L.Util.getParamString(params),true);xmlHttp.setRequestHeader("Accept","application/json");xmlHttp.send(null)},template:function(str,data){return str.replace(/\{ *([\w_]+) *\}/g,function(str,key){var value=data[key];if(value===undefined){value=""}else if(typeof value==="function"){value=value(data)}return htmlEscape(value)})},htmlEscape:htmlEscape}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[12])(12)});